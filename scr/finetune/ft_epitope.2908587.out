[Data] X shape=(500, 22), #classes=116
[Split] Train=347, Val=98, Test=55
[FT init] loaded 52 keys from backbone, skipped 4
[Note] use_cosine_head enabled -> forcing label_smoothing=0.0
[blocks] mean| HLA=0.0930
[Epoch 001] train_loss=10.3938  val_loss=4.5339  ACC=0.061  F1m=0.021  Top5=0.286  Top1=0.061
[Checkpoint] New best ACC=0.0612 at epoch 1. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 002] train_loss=10.1720  val_loss=4.5290  ACC=0.061  F1m=0.020  Top5=0.286  Top1=0.061
[Epoch 003] train_loss=9.7200  val_loss=4.5191  ACC=0.061  F1m=0.020  Top5=0.296  Top1=0.061
[Epoch 004] train_loss=9.5236  val_loss=4.5051  ACC=0.061  F1m=0.020  Top5=0.296  Top1=0.061
[Epoch 005] train_loss=9.0262  val_loss=4.4880  ACC=0.061  F1m=0.020  Top5=0.296  Top1=0.061
[Epoch 006] train_loss=8.8859  val_loss=4.4699  ACC=0.061  F1m=0.020  Top5=0.296  Top1=0.061
[Epoch 007] train_loss=8.8705  val_loss=4.4494  ACC=0.061  F1m=0.020  Top5=0.316  Top1=0.061
[Epoch 008] train_loss=8.5952  val_loss=4.4270  ACC=0.071  F1m=0.022  Top5=0.316  Top1=0.071
[Checkpoint] New best ACC=0.0714 at epoch 8. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 009] train_loss=8.1821  val_loss=4.4046  ACC=0.071  F1m=0.022  Top5=0.337  Top1=0.071
[Epoch 010] train_loss=8.1761  val_loss=4.3818  ACC=0.082  F1m=0.028  Top5=0.347  Top1=0.082
[Checkpoint] New best ACC=0.0816 at epoch 10. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 011] train_loss=8.0218  val_loss=4.3583  ACC=0.082  F1m=0.028  Top5=0.347  Top1=0.082
[Epoch 012] train_loss=8.1479  val_loss=4.3334  ACC=0.082  F1m=0.028  Top5=0.347  Top1=0.082
[Epoch 013] train_loss=7.5323  val_loss=4.3088  ACC=0.082  F1m=0.028  Top5=0.367  Top1=0.082
[Epoch 014] train_loss=7.6659  val_loss=4.2824  ACC=0.082  F1m=0.028  Top5=0.367  Top1=0.082
[Epoch 015] train_loss=7.3172  val_loss=4.2535  ACC=0.082  F1m=0.028  Top5=0.367  Top1=0.082
[Epoch 016] train_loss=7.5320  val_loss=4.2240  ACC=0.082  F1m=0.028  Top5=0.378  Top1=0.082
[Epoch 017] train_loss=7.0774  val_loss=4.1954  ACC=0.082  F1m=0.028  Top5=0.378  Top1=0.082
[Epoch 018] train_loss=6.9019  val_loss=4.1651  ACC=0.082  F1m=0.028  Top5=0.388  Top1=0.082
[Epoch 019] train_loss=6.9633  val_loss=4.1353  ACC=0.082  F1m=0.028  Top5=0.388  Top1=0.082
[Epoch 020] train_loss=7.0426  val_loss=4.1046  ACC=0.082  F1m=0.028  Top5=0.388  Top1=0.082
[Epoch 021] train_loss=6.9723  val_loss=4.0742  ACC=0.092  F1m=0.029  Top5=0.388  Top1=0.092
[Checkpoint] New best ACC=0.0918 at epoch 21. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 022] train_loss=6.9158  val_loss=4.0426  ACC=0.102  F1m=0.030  Top5=0.408  Top1=0.102
[Checkpoint] New best ACC=0.1020 at epoch 22. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 023] train_loss=6.5605  val_loss=4.0115  ACC=0.102  F1m=0.030  Top5=0.418  Top1=0.102
[Epoch 024] train_loss=6.7188  val_loss=3.9804  ACC=0.102  F1m=0.030  Top5=0.418  Top1=0.102
[Epoch 025] train_loss=6.6746  val_loss=3.9491  ACC=0.102  F1m=0.030  Top5=0.429  Top1=0.102
[Epoch 026] train_loss=6.2501  val_loss=3.9185  ACC=0.102  F1m=0.030  Top5=0.429  Top1=0.102
[Epoch 027] train_loss=6.3882  val_loss=3.8886  ACC=0.112  F1m=0.036  Top5=0.439  Top1=0.112
[Checkpoint] New best ACC=0.1122 at epoch 27. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 028] train_loss=6.0143  val_loss=3.8583  ACC=0.112  F1m=0.036  Top5=0.439  Top1=0.112
[Epoch 029] train_loss=6.2303  val_loss=3.8273  ACC=0.112  F1m=0.036  Top5=0.439  Top1=0.112
[Epoch 030] train_loss=6.2400  val_loss=3.7995  ACC=0.122  F1m=0.038  Top5=0.439  Top1=0.122
[Checkpoint] New best ACC=0.1224 at epoch 30. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 031] train_loss=6.0748  val_loss=3.7725  ACC=0.122  F1m=0.038  Top5=0.439  Top1=0.122
[Epoch 032] train_loss=6.3220  val_loss=3.7456  ACC=0.122  F1m=0.042  Top5=0.439  Top1=0.122
[Epoch 033] train_loss=5.7329  val_loss=3.7185  ACC=0.122  F1m=0.042  Top5=0.439  Top1=0.122
[Epoch 034] train_loss=5.7043  val_loss=3.6920  ACC=0.122  F1m=0.042  Top5=0.439  Top1=0.122
[Epoch 035] train_loss=6.0613  val_loss=3.6660  ACC=0.122  F1m=0.042  Top5=0.449  Top1=0.122
[Epoch 036] train_loss=5.9947  val_loss=3.6408  ACC=0.133  F1m=0.046  Top5=0.449  Top1=0.133
[Checkpoint] New best ACC=0.1327 at epoch 36. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 037] train_loss=5.8884  val_loss=3.6159  ACC=0.143  F1m=0.048  Top5=0.469  Top1=0.143
[Checkpoint] New best ACC=0.1429 at epoch 37. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 038] train_loss=5.7839  val_loss=3.5924  ACC=0.143  F1m=0.048  Top5=0.469  Top1=0.143
[Epoch 039] train_loss=6.0190  val_loss=3.5710  ACC=0.143  F1m=0.048  Top5=0.459  Top1=0.143
[Epoch 040] train_loss=5.9051  val_loss=3.5504  ACC=0.143  F1m=0.048  Top5=0.459  Top1=0.143
[Epoch 041] train_loss=6.0807  val_loss=3.5304  ACC=0.143  F1m=0.048  Top5=0.469  Top1=0.143
[Epoch 042] train_loss=5.8121  val_loss=3.5103  ACC=0.143  F1m=0.048  Top5=0.469  Top1=0.143
[Epoch 043] train_loss=5.9133  val_loss=3.4908  ACC=0.143  F1m=0.048  Top5=0.469  Top1=0.143
[Epoch 044] train_loss=5.7210  val_loss=3.4711  ACC=0.153  F1m=0.052  Top5=0.469  Top1=0.153
[Checkpoint] New best ACC=0.1531 at epoch 44. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 045] train_loss=6.0109  val_loss=3.4526  ACC=0.153  F1m=0.052  Top5=0.469  Top1=0.153
[Epoch 046] train_loss=5.5489  val_loss=3.4344  ACC=0.153  F1m=0.052  Top5=0.469  Top1=0.153
[Epoch 047] train_loss=5.7306  val_loss=3.4161  ACC=0.153  F1m=0.052  Top5=0.469  Top1=0.153
[Epoch 048] train_loss=5.2139  val_loss=3.3992  ACC=0.153  F1m=0.051  Top5=0.480  Top1=0.153
[Epoch 049] train_loss=5.5148  val_loss=3.3822  ACC=0.163  F1m=0.054  Top5=0.490  Top1=0.163
[Checkpoint] New best ACC=0.1633 at epoch 49. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 050] train_loss=6.1142  val_loss=3.3650  ACC=0.163  F1m=0.054  Top5=0.490  Top1=0.163
[Epoch 051] train_loss=5.5046  val_loss=3.3488  ACC=0.163  F1m=0.055  Top5=0.490  Top1=0.163
[Epoch 052] train_loss=6.2344  val_loss=3.3344  ACC=0.163  F1m=0.055  Top5=0.490  Top1=0.163
[Epoch 053] train_loss=6.0310  val_loss=3.3217  ACC=0.163  F1m=0.054  Top5=0.490  Top1=0.163
[Epoch 054] train_loss=5.5887  val_loss=3.3089  ACC=0.163  F1m=0.054  Top5=0.490  Top1=0.163
[Epoch 055] train_loss=5.7065  val_loss=3.2958  ACC=0.163  F1m=0.054  Top5=0.490  Top1=0.163
[Epoch 056] train_loss=5.7063  val_loss=3.2828  ACC=0.163  F1m=0.054  Top5=0.510  Top1=0.163
[Epoch 057] train_loss=5.7930  val_loss=3.2704  ACC=0.163  F1m=0.054  Top5=0.520  Top1=0.163
[Epoch 058] train_loss=5.7613  val_loss=3.2578  ACC=0.163  F1m=0.054  Top5=0.520  Top1=0.163
[Epoch 059] train_loss=5.7310  val_loss=3.2462  ACC=0.163  F1m=0.054  Top5=0.520  Top1=0.163
[Epoch 060] train_loss=5.5212  val_loss=3.2358  ACC=0.163  F1m=0.054  Top5=0.520  Top1=0.163
[Epoch 061] train_loss=6.1673  val_loss=3.2258  ACC=0.163  F1m=0.063  Top5=0.520  Top1=0.163
[Epoch 062] train_loss=5.5636  val_loss=3.2155  ACC=0.163  F1m=0.063  Top5=0.520  Top1=0.163
[Epoch 063] train_loss=5.7889  val_loss=3.2053  ACC=0.163  F1m=0.063  Top5=0.520  Top1=0.163
[Epoch 064] train_loss=5.9159  val_loss=3.1951  ACC=0.163  F1m=0.063  Top5=0.520  Top1=0.163
[Epoch 065] train_loss=5.9018  val_loss=3.1853  ACC=0.163  F1m=0.063  Top5=0.520  Top1=0.163
[Epoch 066] train_loss=6.1238  val_loss=3.1751  ACC=0.163  F1m=0.063  Top5=0.520  Top1=0.163
[Epoch 067] train_loss=5.2486  val_loss=3.1646  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Checkpoint] New best ACC=0.1735 at epoch 67. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 068] train_loss=5.8820  val_loss=3.1551  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Epoch 069] train_loss=5.4555  val_loss=3.1465  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Epoch 070] train_loss=5.6114  val_loss=3.1384  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Epoch 071] train_loss=6.1852  val_loss=3.1302  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Epoch 072] train_loss=6.2166  val_loss=3.1225  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Epoch 073] train_loss=5.2377  val_loss=3.1151  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Epoch 074] train_loss=5.5645  val_loss=3.1083  ACC=0.173  F1m=0.066  Top5=0.531  Top1=0.173
[Epoch 075] train_loss=6.1252  val_loss=3.1017  ACC=0.173  F1m=0.066  Top5=0.520  Top1=0.173
[Epoch 076] train_loss=5.6641  val_loss=3.0952  ACC=0.173  F1m=0.066  Top5=0.520  Top1=0.173
[Epoch 077] train_loss=5.6666  val_loss=3.0893  ACC=0.173  F1m=0.066  Top5=0.520  Top1=0.173
[Epoch 078] train_loss=5.8817  val_loss=3.0839  ACC=0.163  F1m=0.065  Top5=0.520  Top1=0.163
[Epoch 079] train_loss=5.7259  val_loss=3.0788  ACC=0.163  F1m=0.065  Top5=0.520  Top1=0.163
[Epoch 080] train_loss=5.4985  val_loss=3.0745  ACC=0.173  F1m=0.066  Top5=0.520  Top1=0.173
[Epoch 081] train_loss=5.6972  val_loss=3.0711  ACC=0.163  F1m=0.064  Top5=0.520  Top1=0.163
[Epoch 082] train_loss=5.8471  val_loss=3.0686  ACC=0.184  F1m=0.077  Top5=0.520  Top1=0.184
[Checkpoint] New best ACC=0.1837 at epoch 82. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 083] train_loss=5.3494  val_loss=3.0661  ACC=0.194  F1m=0.078  Top5=0.531  Top1=0.194
[Checkpoint] New best ACC=0.1939 at epoch 83. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 084] train_loss=5.5455  val_loss=3.0634  ACC=0.214  F1m=0.081  Top5=0.531  Top1=0.214
[Checkpoint] New best ACC=0.2143 at epoch 84. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 085] train_loss=5.2627  val_loss=3.0610  ACC=0.224  F1m=0.081  Top5=0.531  Top1=0.224
[Checkpoint] New best ACC=0.2245 at epoch 85. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 086] train_loss=5.8436  val_loss=3.0599  ACC=0.235  F1m=0.082  Top5=0.531  Top1=0.235
[Checkpoint] New best ACC=0.2347 at epoch 86. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 087] train_loss=5.4789  val_loss=3.0593  ACC=0.255  F1m=0.086  Top5=0.531  Top1=0.255
[Checkpoint] New best ACC=0.2551 at epoch 87. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 088] train_loss=5.5457  val_loss=3.0591  ACC=0.255  F1m=0.086  Top5=0.531  Top1=0.255
[Epoch 089] train_loss=5.6782  val_loss=3.0595  ACC=0.255  F1m=0.086  Top5=0.541  Top1=0.255
[Epoch 090] train_loss=5.5059  val_loss=3.0601  ACC=0.255  F1m=0.086  Top5=0.551  Top1=0.255
[Epoch 091] train_loss=5.5073  val_loss=3.0612  ACC=0.265  F1m=0.087  Top5=0.561  Top1=0.265
[Checkpoint] New best ACC=0.2653 at epoch 91. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 092] train_loss=5.4268  val_loss=3.0631  ACC=0.265  F1m=0.087  Top5=0.561  Top1=0.265
[Epoch 093] train_loss=5.6548  val_loss=3.0658  ACC=0.265  F1m=0.089  Top5=0.561  Top1=0.265
[Epoch 094] train_loss=5.7936  val_loss=3.0682  ACC=0.265  F1m=0.089  Top5=0.561  Top1=0.265
[Epoch 095] train_loss=5.7579  val_loss=3.0713  ACC=0.265  F1m=0.089  Top5=0.561  Top1=0.265
[Epoch 096] train_loss=5.3469  val_loss=3.0744  ACC=0.265  F1m=0.089  Top5=0.561  Top1=0.265
[Epoch 097] train_loss=5.9623  val_loss=3.0780  ACC=0.276  F1m=0.090  Top5=0.561  Top1=0.276
[Checkpoint] New best ACC=0.2755 at epoch 97. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 098] train_loss=5.4060  val_loss=3.0820  ACC=0.276  F1m=0.090  Top5=0.561  Top1=0.276
[Epoch 099] train_loss=5.8854  val_loss=3.0864  ACC=0.286  F1m=0.091  Top5=0.561  Top1=0.286
[Checkpoint] New best ACC=0.2857 at epoch 99. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 100] train_loss=5.7673  val_loss=3.0915  ACC=0.296  F1m=0.092  Top5=0.561  Top1=0.296
[Checkpoint] New best ACC=0.2959 at epoch 100. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 101] train_loss=5.5606  val_loss=3.0974  ACC=0.296  F1m=0.092  Top5=0.561  Top1=0.296
[Epoch 102] train_loss=5.9832  val_loss=3.1036  ACC=0.296  F1m=0.092  Top5=0.561  Top1=0.296
[Epoch 103] train_loss=5.6489  val_loss=3.1089  ACC=0.306  F1m=0.093  Top5=0.561  Top1=0.306
[Checkpoint] New best ACC=0.3061 at epoch 103. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 104] train_loss=5.6798  val_loss=3.1146  ACC=0.306  F1m=0.093  Top5=0.561  Top1=0.306
[Epoch 105] train_loss=5.9954  val_loss=3.1206  ACC=0.316  F1m=0.095  Top5=0.561  Top1=0.316
[Checkpoint] New best ACC=0.3163 at epoch 105. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 106] train_loss=5.5869  val_loss=3.1270  ACC=0.316  F1m=0.095  Top5=0.571  Top1=0.316
[Epoch 107] train_loss=5.5453  val_loss=3.1338  ACC=0.316  F1m=0.095  Top5=0.571  Top1=0.316
[Epoch 108] train_loss=5.4907  val_loss=3.1413  ACC=0.327  F1m=0.096  Top5=0.571  Top1=0.327
[Checkpoint] New best ACC=0.3265 at epoch 108. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 109] train_loss=5.6983  val_loss=3.1491  ACC=0.327  F1m=0.096  Top5=0.571  Top1=0.327
[Epoch 110] train_loss=5.7218  val_loss=3.1573  ACC=0.327  F1m=0.096  Top5=0.571  Top1=0.327
[Epoch 111] train_loss=5.5336  val_loss=3.1657  ACC=0.327  F1m=0.096  Top5=0.571  Top1=0.327
[Epoch 112] train_loss=5.7206  val_loss=3.1744  ACC=0.327  F1m=0.096  Top5=0.571  Top1=0.327
[Epoch 113] train_loss=5.5284  val_loss=3.1835  ACC=0.327  F1m=0.096  Top5=0.571  Top1=0.327
[Epoch 114] train_loss=5.6834  val_loss=3.1921  ACC=0.327  F1m=0.096  Top5=0.571  Top1=0.327
[Epoch 115] train_loss=5.4826  val_loss=3.2000  ACC=0.337  F1m=0.098  Top5=0.571  Top1=0.337
[Checkpoint] New best ACC=0.3367 at epoch 115. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 116] train_loss=5.7498  val_loss=3.2078  ACC=0.337  F1m=0.098  Top5=0.571  Top1=0.337
[Epoch 117] train_loss=5.8134  val_loss=3.2158  ACC=0.337  F1m=0.098  Top5=0.571  Top1=0.337
[Epoch 118] train_loss=5.3913  val_loss=3.2249  ACC=0.337  F1m=0.098  Top5=0.571  Top1=0.337
[Epoch 119] train_loss=5.4514  val_loss=3.2343  ACC=0.337  F1m=0.098  Top5=0.571  Top1=0.337
[Epoch 120] train_loss=5.3920  val_loss=3.2436  ACC=0.327  F1m=0.094  Top5=0.571  Top1=0.327
[Epoch 121] train_loss=5.4698  val_loss=3.2531  ACC=0.327  F1m=0.095  Top5=0.571  Top1=0.327
[Epoch 122] train_loss=5.4155  val_loss=3.2620  ACC=0.327  F1m=0.095  Top5=0.592  Top1=0.327
[Epoch 123] train_loss=5.2899  val_loss=3.2714  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 124] train_loss=5.4067  val_loss=3.2811  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 125] train_loss=5.8318  val_loss=3.2918  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 126] train_loss=5.5682  val_loss=3.3024  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 127] train_loss=5.3931  val_loss=3.3130  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 128] train_loss=5.4389  val_loss=3.3242  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 129] train_loss=5.6826  val_loss=3.3361  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 130] train_loss=5.8503  val_loss=3.3469  ACC=0.337  F1m=0.113  Top5=0.592  Top1=0.337
[Epoch 131] train_loss=5.5018  val_loss=3.3575  ACC=0.347  F1m=0.115  Top5=0.592  Top1=0.347
[Checkpoint] New best ACC=0.3469 at epoch 131. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 132] train_loss=5.6976  val_loss=3.3675  ACC=0.347  F1m=0.115  Top5=0.592  Top1=0.347
[Epoch 133] train_loss=5.6109  val_loss=3.3780  ACC=0.347  F1m=0.115  Top5=0.592  Top1=0.347
[Epoch 134] train_loss=5.6229  val_loss=3.3888  ACC=0.347  F1m=0.115  Top5=0.592  Top1=0.347
[Epoch 135] train_loss=5.5115  val_loss=3.3999  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 136] train_loss=5.8280  val_loss=3.4113  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 137] train_loss=5.7255  val_loss=3.4229  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 138] train_loss=5.1271  val_loss=3.4345  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 139] train_loss=5.6037  val_loss=3.4460  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 140] train_loss=5.5714  val_loss=3.4578  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 141] train_loss=5.6337  val_loss=3.4697  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 142] train_loss=5.3417  val_loss=3.4813  ACC=0.347  F1m=0.117  Top5=0.592  Top1=0.347
[Epoch 143] train_loss=5.3640  val_loss=3.4921  ACC=0.367  F1m=0.120  Top5=0.592  Top1=0.367
[Checkpoint] New best ACC=0.3673 at epoch 143. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 144] train_loss=5.7485  val_loss=3.5021  ACC=0.367  F1m=0.120  Top5=0.592  Top1=0.367
[Epoch 145] train_loss=5.4936  val_loss=3.5124  ACC=0.367  F1m=0.120  Top5=0.592  Top1=0.367
[Epoch 146] train_loss=5.8427  val_loss=3.5231  ACC=0.367  F1m=0.120  Top5=0.592  Top1=0.367
[Epoch 147] train_loss=5.3919  val_loss=3.5336  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Checkpoint] New best ACC=0.3776 at epoch 147. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 148] train_loss=5.3740  val_loss=3.5435  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 149] train_loss=4.7212  val_loss=3.5539  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 150] train_loss=5.5248  val_loss=3.5637  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 151] train_loss=5.6157  val_loss=3.5739  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 152] train_loss=5.4706  val_loss=3.5845  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 153] train_loss=5.7389  val_loss=3.5956  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 154] train_loss=5.6732  val_loss=3.6067  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 155] train_loss=5.5455  val_loss=3.6179  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 156] train_loss=5.4528  val_loss=3.6285  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 157] train_loss=5.3420  val_loss=3.6386  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 158] train_loss=6.0559  val_loss=3.6493  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 159] train_loss=6.0327  val_loss=3.6600  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 160] train_loss=5.5840  val_loss=3.6703  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 161] train_loss=5.6170  val_loss=3.6805  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 162] train_loss=5.3985  val_loss=3.6903  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 163] train_loss=5.2829  val_loss=3.7005  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 164] train_loss=6.0001  val_loss=3.7108  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 165] train_loss=5.7485  val_loss=3.7213  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 166] train_loss=5.4718  val_loss=3.7313  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 167] train_loss=5.4970  val_loss=3.7414  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 168] train_loss=5.5434  val_loss=3.7517  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 169] train_loss=5.2145  val_loss=3.7623  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 170] train_loss=5.0046  val_loss=3.7732  ACC=0.378  F1m=0.121  Top5=0.592  Top1=0.378
[Epoch 171] train_loss=5.2987  val_loss=3.7840  ACC=0.378  F1m=0.119  Top5=0.592  Top1=0.378
[Epoch 172] train_loss=5.3408  val_loss=3.7940  ACC=0.378  F1m=0.119  Top5=0.592  Top1=0.378
[Epoch 173] train_loss=5.4453  val_loss=3.8041  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 174] train_loss=5.8262  val_loss=3.8139  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 175] train_loss=5.8742  val_loss=3.8235  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 176] train_loss=5.9247  val_loss=3.8328  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 177] train_loss=5.4791  val_loss=3.8415  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 178] train_loss=5.7666  val_loss=3.8501  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 179] train_loss=5.8421  val_loss=3.8587  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 180] train_loss=5.8586  val_loss=3.8673  ACC=0.378  F1m=0.119  Top5=0.602  Top1=0.378
[Epoch 181] train_loss=5.7931  val_loss=3.8762  ACC=0.388  F1m=0.120  Top5=0.602  Top1=0.388
[Checkpoint] New best ACC=0.3878 at epoch 181. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 182] train_loss=5.6696  val_loss=3.8851  ACC=0.388  F1m=0.120  Top5=0.602  Top1=0.388
[Epoch 183] train_loss=5.1618  val_loss=3.8937  ACC=0.388  F1m=0.120  Top5=0.602  Top1=0.388
[Epoch 184] train_loss=5.9960  val_loss=3.9030  ACC=0.388  F1m=0.120  Top5=0.602  Top1=0.388
[Epoch 185] train_loss=5.0141  val_loss=3.9124  ACC=0.398  F1m=0.121  Top5=0.602  Top1=0.398
[Checkpoint] New best ACC=0.3980 at epoch 185. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 186] train_loss=5.5854  val_loss=3.9218  ACC=0.398  F1m=0.121  Top5=0.602  Top1=0.398
[Epoch 187] train_loss=5.1568  val_loss=3.9309  ACC=0.398  F1m=0.121  Top5=0.602  Top1=0.398
[Epoch 188] train_loss=5.2694  val_loss=3.9395  ACC=0.398  F1m=0.121  Top5=0.602  Top1=0.398
[Epoch 189] train_loss=5.6948  val_loss=3.9479  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 190] train_loss=5.0594  val_loss=3.9569  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 191] train_loss=5.7077  val_loss=3.9663  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 192] train_loss=5.7722  val_loss=3.9758  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 193] train_loss=5.6111  val_loss=3.9853  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 194] train_loss=4.9041  val_loss=3.9948  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 195] train_loss=5.6612  val_loss=4.0037  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 196] train_loss=5.4523  val_loss=4.0125  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 197] train_loss=5.2711  val_loss=4.0213  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 198] train_loss=5.1666  val_loss=4.0306  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 199] train_loss=5.6536  val_loss=4.0396  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 200] train_loss=5.8292  val_loss=4.0487  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 201] train_loss=5.8077  val_loss=4.0574  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 202] train_loss=5.4207  val_loss=4.0663  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 203] train_loss=5.7696  val_loss=4.0751  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 204] train_loss=5.8411  val_loss=4.0839  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 205] train_loss=5.8102  val_loss=4.0927  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 206] train_loss=5.5927  val_loss=4.1014  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 207] train_loss=5.3147  val_loss=4.1095  ACC=0.398  F1m=0.124  Top5=0.602  Top1=0.398
[Epoch 208] train_loss=5.5457  val_loss=4.1171  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Checkpoint] New best ACC=0.4082 at epoch 208. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt
[Epoch 209] train_loss=5.5872  val_loss=4.1251  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 210] train_loss=5.3081  val_loss=4.1334  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 211] train_loss=5.7758  val_loss=4.1422  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 212] train_loss=5.6727  val_loss=4.1513  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 213] train_loss=5.1929  val_loss=4.1606  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 214] train_loss=5.1639  val_loss=4.1699  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 215] train_loss=5.5075  val_loss=4.1790  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 216] train_loss=5.8326  val_loss=4.1883  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 217] train_loss=5.4002  val_loss=4.1971  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 218] train_loss=5.2253  val_loss=4.2053  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 219] train_loss=6.0478  val_loss=4.2131  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 220] train_loss=5.7789  val_loss=4.2206  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 221] train_loss=5.5163  val_loss=4.2283  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 222] train_loss=5.5701  val_loss=4.2355  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 223] train_loss=5.4345  val_loss=4.2431  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 224] train_loss=5.2616  val_loss=4.2508  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 225] train_loss=5.7433  val_loss=4.2586  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 226] train_loss=5.4123  val_loss=4.2663  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 227] train_loss=5.4946  val_loss=4.2739  ACC=0.408  F1m=0.130  Top5=0.602  Top1=0.408
[Epoch 228] train_loss=5.6967  val_loss=4.2813  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 229] train_loss=5.6502  val_loss=4.2889  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 230] train_loss=5.2030  val_loss=4.2956  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 231] train_loss=5.9593  val_loss=4.3021  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 232] train_loss=5.5355  val_loss=4.3086  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 233] train_loss=4.9354  val_loss=4.3149  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 234] train_loss=5.8567  val_loss=4.3210  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 235] train_loss=5.2128  val_loss=4.3274  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 236] train_loss=5.0094  val_loss=4.3337  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 237] train_loss=5.7726  val_loss=4.3400  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 238] train_loss=5.6169  val_loss=4.3463  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 239] train_loss=5.2684  val_loss=4.3522  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 240] train_loss=5.4424  val_loss=4.3583  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 241] train_loss=5.6555  val_loss=4.3647  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 242] train_loss=5.6697  val_loss=4.3710  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 243] train_loss=5.4429  val_loss=4.3773  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 244] train_loss=5.7587  val_loss=4.3839  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 245] train_loss=5.4509  val_loss=4.3902  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 246] train_loss=5.4396  val_loss=4.3961  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 247] train_loss=5.6920  val_loss=4.4021  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 248] train_loss=5.6112  val_loss=4.4077  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 249] train_loss=5.7649  val_loss=4.4136  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 250] train_loss=5.4689  val_loss=4.4192  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 251] train_loss=5.5948  val_loss=4.4253  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 252] train_loss=5.6689  val_loss=4.4314  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 253] train_loss=5.9387  val_loss=4.4376  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 254] train_loss=5.2680  val_loss=4.4438  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 255] train_loss=5.6252  val_loss=4.4495  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 256] train_loss=5.5498  val_loss=4.4552  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 257] train_loss=5.6236  val_loss=4.4607  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 258] train_loss=5.3308  val_loss=4.4660  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 259] train_loss=5.4235  val_loss=4.4712  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 260] train_loss=5.8291  val_loss=4.4762  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 261] train_loss=5.3450  val_loss=4.4808  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 262] train_loss=5.7381  val_loss=4.4857  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 263] train_loss=5.2940  val_loss=4.4902  ACC=0.398  F1m=0.125  Top5=0.602  Top1=0.398
[Epoch 264] train_loss=5.4748  val_loss=4.4949  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 265] train_loss=5.2609  val_loss=4.4997  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 266] train_loss=5.3860  val_loss=4.5045  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 267] train_loss=5.4518  val_loss=4.5090  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 268] train_loss=5.4066  val_loss=4.5134  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 269] train_loss=5.4847  val_loss=4.5176  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 270] train_loss=5.5659  val_loss=4.5220  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 271] train_loss=5.7726  val_loss=4.5262  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 272] train_loss=5.5383  val_loss=4.5305  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 273] train_loss=5.3575  val_loss=4.5349  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 274] train_loss=5.5672  val_loss=4.5392  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 275] train_loss=5.6511  val_loss=4.5432  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 276] train_loss=5.3188  val_loss=4.5470  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 277] train_loss=5.5424  val_loss=4.5512  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 278] train_loss=5.7016  val_loss=4.5553  ACC=0.398  F1m=0.122  Top5=0.592  Top1=0.398
[Epoch 279] train_loss=5.7894  val_loss=4.5599  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 280] train_loss=5.5233  val_loss=4.5640  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 281] train_loss=5.4338  val_loss=4.5679  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 282] train_loss=5.8119  val_loss=4.5715  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 283] train_loss=5.6439  val_loss=4.5750  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 284] train_loss=5.0510  val_loss=4.5789  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 285] train_loss=5.8114  val_loss=4.5830  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 286] train_loss=5.8597  val_loss=4.5870  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 287] train_loss=5.8648  val_loss=4.5907  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 288] train_loss=5.4722  val_loss=4.5945  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 289] train_loss=5.3744  val_loss=4.5978  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 290] train_loss=5.8941  val_loss=4.6015  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 291] train_loss=5.5914  val_loss=4.6051  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 292] train_loss=5.6737  val_loss=4.6089  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 293] train_loss=5.6521  val_loss=4.6131  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 294] train_loss=5.2721  val_loss=4.6173  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 295] train_loss=5.4239  val_loss=4.6216  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 296] train_loss=5.4023  val_loss=4.6257  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 297] train_loss=5.6587  val_loss=4.6289  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 298] train_loss=5.6144  val_loss=4.6323  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 299] train_loss=5.5210  val_loss=4.6352  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 300] train_loss=5.6575  val_loss=4.6381  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 301] train_loss=5.5875  val_loss=4.6407  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 302] train_loss=5.1295  val_loss=4.6436  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 303] train_loss=5.4216  val_loss=4.6464  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 304] train_loss=5.5559  val_loss=4.6496  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 305] train_loss=5.2207  val_loss=4.6530  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 306] train_loss=5.6156  val_loss=4.6566  ACC=0.398  F1m=0.125  Top5=0.592  Top1=0.398
[Epoch 307] train_loss=5.3760  val_loss=4.6599  ACC=0.398  F1m=0.122  Top5=0.592  Top1=0.398
[Epoch 308] train_loss=5.2257  val_loss=4.6630  ACC=0.398  F1m=0.122  Top5=0.592  Top1=0.398
[Epoch 309] train_loss=5.6951  val_loss=4.6658  ACC=0.398  F1m=0.122  Top5=0.592  Top1=0.398
[Epoch 310] train_loss=5.7585  val_loss=4.6687  ACC=0.398  F1m=0.122  Top5=0.592  Top1=0.398
[Epoch 311] train_loss=5.6816  val_loss=4.6715  ACC=0.398  F1m=0.120  Top5=0.592  Top1=0.398
[Epoch 312] train_loss=5.4606  val_loss=4.6743  ACC=0.398  F1m=0.120  Top5=0.592  Top1=0.398
[Epoch 313] train_loss=5.5342  val_loss=4.6772  ACC=0.388  F1m=0.114  Top5=0.592  Top1=0.388
[Epoch 314] train_loss=5.2940  val_loss=4.6804  ACC=0.388  F1m=0.114  Top5=0.592  Top1=0.388
[Epoch 315] train_loss=5.5351  val_loss=4.6833  ACC=0.388  F1m=0.114  Top5=0.592  Top1=0.388
[Epoch 316] train_loss=5.6473  val_loss=4.6867  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 317] train_loss=5.2579  val_loss=4.6898  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 318] train_loss=5.7943  val_loss=4.6930  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 319] train_loss=5.7663  val_loss=4.6961  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 320] train_loss=5.2851  val_loss=4.6991  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 321] train_loss=5.3647  val_loss=4.7022  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 322] train_loss=5.4012  val_loss=4.7051  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 323] train_loss=5.7577  val_loss=4.7080  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 324] train_loss=5.4908  val_loss=4.7111  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 325] train_loss=5.6331  val_loss=4.7137  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 326] train_loss=5.7666  val_loss=4.7162  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 327] train_loss=5.6267  val_loss=4.7183  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 328] train_loss=5.7130  val_loss=4.7208  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 329] train_loss=5.5897  val_loss=4.7231  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 330] train_loss=5.2420  val_loss=4.7256  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 331] train_loss=5.2010  val_loss=4.7280  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 332] train_loss=5.5557  val_loss=4.7306  ACC=0.388  F1m=0.114  Top5=0.582  Top1=0.388
[Epoch 333] train_loss=5.5348  val_loss=4.7338  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 334] train_loss=5.4284  val_loss=4.7369  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 335] train_loss=5.4268  val_loss=4.7405  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 336] train_loss=5.4815  val_loss=4.7437  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 337] train_loss=5.1813  val_loss=4.7464  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 338] train_loss=5.6473  val_loss=4.7490  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 339] train_loss=5.8607  val_loss=4.7517  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 340] train_loss=5.6515  val_loss=4.7539  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 341] train_loss=5.3026  val_loss=4.7561  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 342] train_loss=5.5268  val_loss=4.7585  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 343] train_loss=5.3997  val_loss=4.7609  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 344] train_loss=5.8273  val_loss=4.7634  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 345] train_loss=5.6137  val_loss=4.7662  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 346] train_loss=4.9714  val_loss=4.7689  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 347] train_loss=5.2784  val_loss=4.7723  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 348] train_loss=5.5381  val_loss=4.7751  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 349] train_loss=5.0818  val_loss=4.7782  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 350] train_loss=5.2799  val_loss=4.7808  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 351] train_loss=5.1959  val_loss=4.7834  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 352] train_loss=5.8210  val_loss=4.7861  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 353] train_loss=5.3883  val_loss=4.7887  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 354] train_loss=5.6493  val_loss=4.7916  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 355] train_loss=5.5346  val_loss=4.7943  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 356] train_loss=5.3811  val_loss=4.7969  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 357] train_loss=5.6834  val_loss=4.7994  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 358] train_loss=5.5858  val_loss=4.8017  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 359] train_loss=5.3338  val_loss=4.8043  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 360] train_loss=5.4496  val_loss=4.8067  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 361] train_loss=5.2698  val_loss=4.8088  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 362] train_loss=5.1778  val_loss=4.8112  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 363] train_loss=5.6105  val_loss=4.8134  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 364] train_loss=5.4066  val_loss=4.8157  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 365] train_loss=5.6270  val_loss=4.8175  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 366] train_loss=5.1887  val_loss=4.8194  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 367] train_loss=5.6118  val_loss=4.8213  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 368] train_loss=5.3619  val_loss=4.8231  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 369] train_loss=5.1269  val_loss=4.8249  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 370] train_loss=5.6673  val_loss=4.8265  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 371] train_loss=5.5826  val_loss=4.8282  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 372] train_loss=5.7470  val_loss=4.8300  ACC=0.378  F1m=0.113  Top5=0.582  Top1=0.378
[Epoch 373] train_loss=5.4560  val_loss=4.8315  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 374] train_loss=5.6137  val_loss=4.8335  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 375] train_loss=5.4556  val_loss=4.8353  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 376] train_loss=5.3303  val_loss=4.8372  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 377] train_loss=5.6593  val_loss=4.8388  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 378] train_loss=5.4926  val_loss=4.8408  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 379] train_loss=5.3195  val_loss=4.8427  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 380] train_loss=5.3719  val_loss=4.8444  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 381] train_loss=5.9092  val_loss=4.8463  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 382] train_loss=5.2092  val_loss=4.8482  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 383] train_loss=5.7678  val_loss=4.8501  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 384] train_loss=5.4768  val_loss=4.8525  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 385] train_loss=5.4959  val_loss=4.8545  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 386] train_loss=5.5916  val_loss=4.8563  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 387] train_loss=5.6901  val_loss=4.8584  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 388] train_loss=5.5524  val_loss=4.8599  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 389] train_loss=4.8846  val_loss=4.8618  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 390] train_loss=5.5156  val_loss=4.8635  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 391] train_loss=5.2507  val_loss=4.8655  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 392] train_loss=5.4715  val_loss=4.8675  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 393] train_loss=5.3270  val_loss=4.8694  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 394] train_loss=5.2736  val_loss=4.8709  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 395] train_loss=5.3922  val_loss=4.8729  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 396] train_loss=5.7038  val_loss=4.8748  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 397] train_loss=5.2398  val_loss=4.8769  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 398] train_loss=5.0922  val_loss=4.8787  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 399] train_loss=5.3240  val_loss=4.8807  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 400] train_loss=6.1860  val_loss=4.8826  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 401] train_loss=5.5368  val_loss=4.8841  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 402] train_loss=5.4020  val_loss=4.8858  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 403] train_loss=5.4823  val_loss=4.8878  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 404] train_loss=5.5255  val_loss=4.8893  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 405] train_loss=4.9502  val_loss=4.8907  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 406] train_loss=5.2923  val_loss=4.8923  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 407] train_loss=5.7031  val_loss=4.8935  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
[Epoch 408] train_loss=5.3935  val_loss=4.8950  ACC=0.378  F1m=0.115  Top5=0.582  Top1=0.378
Early stop at epoch 408 (no improve 200/200).
[Temp scaling] learned T = 3.837

=== TEST (FT) ===  ACC=0.545  F1m=0.311  Top5=0.945  Top10=0.982
[Best FT Model Saved] /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/best_acc.pt (includes temperature).
Saved: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/finetune_results/test_predictions_ft.csv
