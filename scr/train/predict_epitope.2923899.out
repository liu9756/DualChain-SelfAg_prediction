[blocks] mean| HLA=0.0078
[Epoch 001] train_loss=11.6013  val_loss=6.1615  ACC=0.001  F1m=0.003  Top5=0.009  Top1=0.001
[Checkpoint] New best ACC=0.0012 at epoch 1. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 002] train_loss=10.9438  val_loss=5.8506  ACC=0.001  F1m=0.003  Top5=0.015  Top1=0.001
[Epoch 003] train_loss=10.3814  val_loss=5.3852  ACC=0.001  F1m=0.003  Top5=0.055  Top1=0.001
[Epoch 004] train_loss=9.6235  val_loss=4.7688  ACC=0.038  F1m=0.003  Top5=0.074  Top1=0.038
[Checkpoint] New best ACC=0.0380 at epoch 4. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 005] train_loss=8.8700  val_loss=4.0876  ACC=0.071  F1m=0.004  Top5=0.168  Top1=0.071
[Checkpoint] New best ACC=0.0714 at epoch 5. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 006] train_loss=8.2359  val_loss=3.3882  ACC=0.278  F1m=0.011  Top5=0.644  Top1=0.278
[Checkpoint] New best ACC=0.2781 at epoch 6. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 007] train_loss=7.7348  val_loss=2.6916  ACC=0.591  F1m=0.026  Top5=0.732  Top1=0.591
[Checkpoint] New best ACC=0.5914 at epoch 7. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 008] train_loss=7.3084  val_loss=2.0746  ACC=0.645  F1m=0.050  Top5=0.779  Top1=0.645
[Checkpoint] New best ACC=0.6448 at epoch 8. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 009] train_loss=6.9460  val_loss=1.6346  ACC=0.679  F1m=0.087  Top5=0.828  Top1=0.679
[Checkpoint] New best ACC=0.6792 at epoch 9. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 010] train_loss=6.5956  val_loss=1.3781  ACC=0.698  F1m=0.109  Top5=0.863  Top1=0.698
[Checkpoint] New best ACC=0.6984 at epoch 10. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 011] train_loss=6.3410  val_loss=1.2258  ACC=0.714  F1m=0.140  Top5=0.884  Top1=0.714
[Checkpoint] New best ACC=0.7138 at epoch 11. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 012] train_loss=6.1156  val_loss=1.1186  ACC=0.732  F1m=0.191  Top5=0.902  Top1=0.732
[Checkpoint] New best ACC=0.7320 at epoch 12. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 013] train_loss=5.8385  val_loss=1.0382  ACC=0.744  F1m=0.214  Top5=0.915  Top1=0.744
[Checkpoint] New best ACC=0.7443 at epoch 13. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 014] train_loss=5.6391  val_loss=0.9781  ACC=0.753  F1m=0.234  Top5=0.923  Top1=0.753
[Checkpoint] New best ACC=0.7532 at epoch 14. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 015] train_loss=5.3815  val_loss=0.9355  ACC=0.761  F1m=0.253  Top5=0.929  Top1=0.761
[Checkpoint] New best ACC=0.7609 at epoch 15. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 016] train_loss=5.1953  val_loss=0.9058  ACC=0.770  F1m=0.280  Top5=0.932  Top1=0.770
[Checkpoint] New best ACC=0.7700 at epoch 16. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 017] train_loss=5.0372  val_loss=0.8845  ACC=0.774  F1m=0.295  Top5=0.933  Top1=0.774
[Checkpoint] New best ACC=0.7743 at epoch 17. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 018] train_loss=4.8026  val_loss=0.8701  ACC=0.780  F1m=0.317  Top5=0.933  Top1=0.780
[Checkpoint] New best ACC=0.7803 at epoch 18. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 019] train_loss=4.6429  val_loss=0.8602  ACC=0.783  F1m=0.324  Top5=0.934  Top1=0.783
[Checkpoint] New best ACC=0.7827 at epoch 19. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 020] train_loss=4.3277  val_loss=0.8540  ACC=0.785  F1m=0.337  Top5=0.937  Top1=0.785
[Checkpoint] New best ACC=0.7851 at epoch 20. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 021] train_loss=4.1751  val_loss=0.8503  ACC=0.788  F1m=0.352  Top5=0.938  Top1=0.788
[Checkpoint] New best ACC=0.7878 at epoch 21. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 022] train_loss=3.9207  val_loss=0.8484  ACC=0.789  F1m=0.362  Top5=0.938  Top1=0.789
[Checkpoint] New best ACC=0.7890 at epoch 22. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 023] train_loss=3.7488  val_loss=0.8469  ACC=0.790  F1m=0.366  Top5=0.937  Top1=0.790
[Checkpoint] New best ACC=0.7902 at epoch 23. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 024] train_loss=3.5216  val_loss=0.8484  ACC=0.792  F1m=0.373  Top5=0.937  Top1=0.792
[Checkpoint] New best ACC=0.7921 at epoch 24. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 025] train_loss=3.2818  val_loss=0.8507  ACC=0.794  F1m=0.376  Top5=0.938  Top1=0.794
[Checkpoint] New best ACC=0.7938 at epoch 25. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 026] train_loss=3.0519  val_loss=0.8554  ACC=0.794  F1m=0.380  Top5=0.937  Top1=0.794
[Epoch 027] train_loss=2.8126  val_loss=0.8604  ACC=0.795  F1m=0.388  Top5=0.936  Top1=0.795
[Checkpoint] New best ACC=0.7950 at epoch 27. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 028] train_loss=2.5970  val_loss=0.8667  ACC=0.795  F1m=0.392  Top5=0.937  Top1=0.795
[Epoch 029] train_loss=2.4016  val_loss=0.8748  ACC=0.794  F1m=0.395  Top5=0.938  Top1=0.794
[Epoch 030] train_loss=2.1878  val_loss=0.8841  ACC=0.794  F1m=0.396  Top5=0.938  Top1=0.794
[Epoch 031] train_loss=2.0592  val_loss=0.8940  ACC=0.795  F1m=0.400  Top5=0.939  Top1=0.795
[Epoch 032] train_loss=1.8767  val_loss=0.9052  ACC=0.796  F1m=0.403  Top5=0.939  Top1=0.796
[Checkpoint] New best ACC=0.7962 at epoch 32. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 033] train_loss=1.7711  val_loss=0.9177  ACC=0.797  F1m=0.410  Top5=0.938  Top1=0.797
[Checkpoint] New best ACC=0.7967 at epoch 33. Saved to: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt
[Epoch 034] train_loss=1.6853  val_loss=0.9315  ACC=0.795  F1m=0.401  Top5=0.938  Top1=0.795
[Epoch 035] train_loss=1.5625  val_loss=0.9458  ACC=0.794  F1m=0.397  Top5=0.937  Top1=0.794
[Epoch 036] train_loss=1.5049  val_loss=0.9622  ACC=0.795  F1m=0.398  Top5=0.938  Top1=0.795
[Epoch 037] train_loss=1.3823  val_loss=0.9789  ACC=0.795  F1m=0.404  Top5=0.938  Top1=0.795
[Epoch 038] train_loss=1.3286  val_loss=0.9954  ACC=0.795  F1m=0.403  Top5=0.938  Top1=0.795
[Epoch 039] train_loss=1.2502  val_loss=1.0125  ACC=0.794  F1m=0.402  Top5=0.939  Top1=0.794
[Epoch 040] train_loss=1.2271  val_loss=1.0301  ACC=0.792  F1m=0.405  Top5=0.939  Top1=0.792
[Epoch 041] train_loss=1.1803  val_loss=1.0484  ACC=0.791  F1m=0.404  Top5=0.940  Top1=0.791
[Epoch 042] train_loss=1.1053  val_loss=1.0676  ACC=0.792  F1m=0.406  Top5=0.940  Top1=0.792
[Epoch 043] train_loss=1.0493  val_loss=1.0879  ACC=0.790  F1m=0.408  Top5=0.939  Top1=0.790
[Epoch 044] train_loss=1.0285  val_loss=1.1081  ACC=0.789  F1m=0.408  Top5=0.939  Top1=0.789
[Epoch 045] train_loss=1.0305  val_loss=1.1301  ACC=0.788  F1m=0.408  Top5=0.940  Top1=0.788
[Epoch 046] train_loss=0.9675  val_loss=1.1479  ACC=0.786  F1m=0.412  Top5=0.938  Top1=0.786
[Epoch 047] train_loss=0.9691  val_loss=1.1660  ACC=0.784  F1m=0.411  Top5=0.935  Top1=0.784
[Epoch 048] train_loss=0.9420  val_loss=1.1876  ACC=0.782  F1m=0.408  Top5=0.935  Top1=0.782
[Epoch 049] train_loss=0.8573  val_loss=1.2132  ACC=0.781  F1m=0.402  Top5=0.935  Top1=0.781
[Epoch 050] train_loss=0.8842  val_loss=1.2350  ACC=0.781  F1m=0.406  Top5=0.934  Top1=0.781
[Epoch 051] train_loss=0.8007  val_loss=1.2583  ACC=0.779  F1m=0.400  Top5=0.934  Top1=0.779
[Epoch 052] train_loss=0.8067  val_loss=1.2827  ACC=0.778  F1m=0.400  Top5=0.933  Top1=0.778
[Epoch 053] train_loss=0.7846  val_loss=1.3020  ACC=0.778  F1m=0.405  Top5=0.932  Top1=0.778
[Epoch 054] train_loss=0.7479  val_loss=1.3219  ACC=0.777  F1m=0.404  Top5=0.930  Top1=0.777
[Epoch 055] train_loss=0.7129  val_loss=1.3422  ACC=0.774  F1m=0.407  Top5=0.931  Top1=0.774
[Epoch 056] train_loss=0.7391  val_loss=1.3630  ACC=0.772  F1m=0.406  Top5=0.930  Top1=0.772
[Epoch 057] train_loss=0.6964  val_loss=1.3816  ACC=0.772  F1m=0.405  Top5=0.930  Top1=0.772
[Epoch 058] train_loss=0.6914  val_loss=1.4031  ACC=0.772  F1m=0.401  Top5=0.929  Top1=0.772
[Epoch 059] train_loss=0.6289  val_loss=1.4202  ACC=0.773  F1m=0.403  Top5=0.930  Top1=0.773
[Epoch 060] train_loss=0.6382  val_loss=1.4357  ACC=0.772  F1m=0.404  Top5=0.929  Top1=0.772
[Epoch 061] train_loss=0.6415  val_loss=1.4526  ACC=0.772  F1m=0.400  Top5=0.929  Top1=0.772
[Epoch 062] train_loss=0.6619  val_loss=1.4702  ACC=0.771  F1m=0.398  Top5=0.926  Top1=0.771
[Epoch 063] train_loss=0.6119  val_loss=1.4892  ACC=0.770  F1m=0.395  Top5=0.926  Top1=0.770
[Epoch 064] train_loss=0.6278  val_loss=1.5068  ACC=0.770  F1m=0.396  Top5=0.925  Top1=0.770
[Epoch 065] train_loss=0.5997  val_loss=1.5258  ACC=0.769  F1m=0.396  Top5=0.922  Top1=0.769
[Epoch 066] train_loss=0.5993  val_loss=1.5394  ACC=0.768  F1m=0.397  Top5=0.921  Top1=0.768
[Epoch 067] train_loss=0.5796  val_loss=1.5556  ACC=0.767  F1m=0.396  Top5=0.921  Top1=0.767
[Epoch 068] train_loss=0.6059  val_loss=1.5714  ACC=0.766  F1m=0.393  Top5=0.920  Top1=0.766
[Epoch 069] train_loss=0.6062  val_loss=1.5846  ACC=0.767  F1m=0.390  Top5=0.921  Top1=0.767
[Epoch 070] train_loss=0.5987  val_loss=1.5963  ACC=0.767  F1m=0.385  Top5=0.921  Top1=0.767
[Epoch 071] train_loss=0.5612  val_loss=1.6058  ACC=0.768  F1m=0.391  Top5=0.921  Top1=0.768
[Epoch 072] train_loss=0.5693  val_loss=1.6150  ACC=0.771  F1m=0.393  Top5=0.921  Top1=0.771
[Epoch 073] train_loss=0.5805  val_loss=1.6236  ACC=0.769  F1m=0.391  Top5=0.920  Top1=0.769
[Epoch 074] train_loss=0.5686  val_loss=1.6301  ACC=0.770  F1m=0.396  Top5=0.920  Top1=0.770
[Epoch 075] train_loss=0.5248  val_loss=1.6406  ACC=0.770  F1m=0.392  Top5=0.920  Top1=0.770
[Epoch 076] train_loss=0.5332  val_loss=1.6504  ACC=0.770  F1m=0.395  Top5=0.919  Top1=0.770
[Epoch 077] train_loss=0.5200  val_loss=1.6586  ACC=0.770  F1m=0.393  Top5=0.919  Top1=0.770
[Epoch 078] train_loss=0.5415  val_loss=1.6660  ACC=0.770  F1m=0.391  Top5=0.918  Top1=0.770
[Epoch 079] train_loss=0.5231  val_loss=1.6732  ACC=0.768  F1m=0.390  Top5=0.919  Top1=0.768
[Epoch 080] train_loss=0.5493  val_loss=1.6819  ACC=0.769  F1m=0.391  Top5=0.918  Top1=0.769
[Epoch 081] train_loss=0.5402  val_loss=1.6876  ACC=0.771  F1m=0.393  Top5=0.918  Top1=0.771
[Epoch 082] train_loss=0.5187  val_loss=1.6949  ACC=0.769  F1m=0.388  Top5=0.918  Top1=0.769
[Epoch 083] train_loss=0.5348  val_loss=1.7028  ACC=0.768  F1m=0.385  Top5=0.918  Top1=0.768
Early stop at epoch 83 (no improve 50/50).
[Temp scaling] learned T = 1.387

=== TEST ===  ACC=0.794  F1m=0.425  Top5=0.939  Top10=0.957
[Best Model Saved] /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/best_acc.pt (includes temperature).
Saved: /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10/test_predictions.csv

#!/bin/bash
#SBATCH -J predict_epitope       
#SBATCH -A PAS2177         
#SBATCH --gpus=2   
#SBATCH --mem=128G          
#SBATCH -t 3:00:00       
#SBATCH -o predict_epitope.%j.out  
#SBATCH -e predict_epitope.%j.err  
python /users/PAS2177/liu9756/DualChain-SelfAg_prediction/scr/train/train_epitope_classifier.py --data /users/PAS2177/liu9756/DualChain-SelfAg_prediction/data/featurized_min10 --outdir /users/PAS2177/liu9756/DualChain-SelfAg_prediction/results/train_results_min10 --epochs 1000 --bs 128 --lr 1e-4 --wd 2e-4 --d_model 256 --use_hla 1 --use_seq_a 1 --use_seq_b 1 --use_cosine_head 1 --use_focal 1 --label_smoothing 0 --use_sampler 1 --sched cosine --early_stop 1 --early_stop_patience 50 --temp_scale 1 